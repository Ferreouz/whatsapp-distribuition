SELECT
NVL(B.NUMCARTEIRA,B.NUMCARTEIRA3) AS CARTEIRA,
B.NUMBANCO AS CODBANCO,
B.AGENCIA AS AGENCIA,
B.CONTA AS CONTA,
to_char((NVL(D.VALOR,0) - NVL(D.VALORDESC,0) + NVL(D.VLTXBOLETO,0)),'999999D99') AS VALOR,
D.VALORDESC AS DESCONTO,
D.DTVENC AS DATAVENCIMENTO,
D.CODBARRA AS CODBARRA,
D.LINHADIG AS LINHADIGITAVEL,
D.NOSSONUMBCO AS NOSSO_NUMERO,
N.NUMNOTA AS NUMERODOCUMENTO,
N.CLIENTE AS CLIENTE,
N.CGC AS CNPJ,
N.ENDERECO AS ENDERECO,
N.BAIRRO AS BAIRRO,
N.CEP AS CEP,
N.MUNICIPIO AS MUNICIPIO,
N.OBSNFE AS OBSERVACAO ,
F.RAZAOSOCIAL AS BENEFICIARIO,
N.CGCFILIAL AS CNPJBENEFICIARIO,
'COBRAR MORA DIARIA DE R$ 1,34 POR DIA DE ATRASO\nAPÓS O VENCIMENTO COBRAR MULTA DE 2%\n\nBoletos após o vencimento poderão ser pagos em qualquer banco.\nTítulos vencidos serão atualizados automaticamente pelo banco.\nProtestar 10 dias após o vencimento\n' AS INSTRUCOES
FROM PCNFSAID N,
PCPREST D,
PCBANCO B,
PCFILIAL F
WHERE
N.NUMNOTA = D.DUPLIC
AND N.CODFILIAL = D.CODFILIAL
AND D.CODBANCOCM = B.CODBANCO
AND N.CODFILIAL = F.CODIGO
AND REPLACE(REPLACE(REPLACE(N.CGC,'.',''), '/',''),'-','') = {{flow.cpfCnpj}}
AND N.NUMNOTA = {{flow.numnota}}
AND D.DTPAG IS NULL
AND D.LINHADIG IS NOT NULL
AND D.CODBARRA IS NOT NULL

ORDER BY D.DTVENC